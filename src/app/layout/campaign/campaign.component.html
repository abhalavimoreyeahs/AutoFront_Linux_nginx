<div style="background-color:#ecf0f5;" >
  <div style="margin-right: 1%;">
  
    <button mat-button (click)="addCampaign()"
      style="float: right;background-color:rgb(146, 84, 226); max-width: 200px; max-height: 100px; margin-top:1%; color:white">
      <mat-icon>add</mat-icon> Add Campaign
    </button>
  
    <button mat-button (click)="stopAllCampaign()"
    style="float: right;background-color:#ce2b2b; max-width: 200px; max-height: 100px; margin-top:1%;  margin-right: 1%; color:white">
    <mat-icon>stop</mat-icon> Stop All Campaign
   </button>
  
  </div>
  
  <div class="container" *ngIf="addCampaignBoolean">
  
    <mat-toolbar>
      <div class="container-fluid">
        <span>Campaigns Details</span>
      </div>
    </mat-toolbar>
    <mat-card class="my-card">
     
  
      <mat-card-content class="z-depth center" flex="50">
        <form>
  
          <mat-form-field>
            <mat-label>Campaigns Name</mat-label>
            <input matInput placeholder="Campaigns Name" style="max-width: 100px" [(ngModel)]="campingname"
              name="campingname" [value]="" required>
  
  
          </mat-form-field>
  
          <mat-form-field style="margin-left:20%">
            <mat-label>Start Date</mat-label>
            <input matInput [matDatepicker]="picker" placeholder="Choose a date" [(ngModel)]="startdate" name="startdate">
            <mat-datepicker-toggle matSuffix [for]="picker" (click)="selectDate(startdate)"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field><br>
  
  
          <mat-form-field>
            <mat-select placeholder="Assign To Manager" name="assignedto" [(ngModel)]="assignedto">
              <mat-option *ngFor="let role of ManagerData" [value]="role.id">{{ role.email }}</mat-option>
            </mat-select>
          </mat-form-field>
        
  
          <mat-form-field style="margin-left:20%">
            <mat-label>Select Campaign Members</mat-label>
            <!-- <mat-select multiple name="campingmembers" [(ngModel)]="campingmembers">
              <mat-option *ngFor="let customer of CustomerData" [value]="customer.Mobile">{{customer.Name}}</mat-option> -->
              <mat-select multiple name="customerIds" [(ngModel)]="customerIds">
                  <mat-option *ngFor="let customer of CustomerData" [value]="customer._id">{{customer.Name}}</mat-option>
            </mat-select>
          </mat-form-field><br>
  
  <div class="container" style="margin-top:3%">
      <div class="row">
   
    <div id="upload_button">
        <label>
          <input type="file"  (change)="incomingfile($event)" multiple>
          <!-- <span class="btn btn-primary" style="background-color: white;color:black;   width: 100px;">Select file</span> -->
        </label>
        <button type="submit" class="btn btn-primary" style="margin-top:-3%; background-color: white;color:black" (click)="Upload()">Upload</button>
      </div>
     
    </div>
    <span style="margin-left:-13px"> {{selectedFile}}</span>
  </div>
  
  
  
          <mat-card-content style="padding:1%">
            <form class="my-form">
         
            </form>
          </mat-card-content>
          <mat-card-actions style=" margin:auto;display:block;padding-left: 14%;">
            <button mat-raised-button (click)="SaveAndEdit()" color="primary"
              style="padding:0px 35px 0px 35px">{{Display}}</button>
            <button mat-raised-button (click)="Cancel()" color="bg-danger"
              style="margin-left:12%; padding:0px 35px 0px 35px; background-color:brown">Cancel</button>
          </mat-card-actions>
  
        </form>
      </mat-card-content>
  
      <mat-card-actions>
      
      </mat-card-actions>
    </mat-card>
  
  </div>
  <!------------------------------------------------------------------------------->
  
  <section class="content-header" style="max-width:50%" *ngIf="!addCampaignBoolean">
      <h2>
        Campaign Details 
        <small>All Campaign</small>
      </h2>
    </section>
  
    <div class="box" *ngIf="!addCampaignBoolean">
  <div >
    
    <table mat-table matSort [dataSource]="CampaignData" >
      <ng-container matColumnDef="S No">
  
        <th mat-header-cell mat-sort-header *matHeaderCellDef><h6>S No </h6></th>
        <td mat-cell *matCellDef="let user; let i = index;"> {{i+1}} </td>
      </ng-container>
      <ng-container matColumnDef="campigname">
        <th mat-header-cell mat-sort-header *matHeaderCellDef><h6>Campaign Name </h6></th>
        <td mat-cell *matCellDef="let user"> {{user.campingname | titlecase }} </td>
      </ng-container>
      <ng-container matColumnDef="createdAt">
          <th mat-header-cell mat-sort-header *matHeaderCellDef><h6> Created At </h6></th>
          <td mat-cell *matCellDef="let user"> {{user.createdAt | date: 'dd/MMM/yyyy h:mm:ss a'}} </td>
        </ng-container>
     
      <ng-container matColumnDef="getCreatedByname">
        <th mat-header-cell mat-sort-header *matHeaderCellDef><h6> Created By </h6> </th>
        <td mat-cell *matCellDef="let user"> {{user.createdby.users.firstName}} {{user.createdby.users.lastName}} </td>
      </ng-container>
      <ng-container matColumnDef="assignedtoByname">
        <th mat-header-cell mat-sort-header *matHeaderCellDef><h6> Assigned To</h6></th>
        <td mat-cell *matCellDef="let user"> {{user.assignedto.users.firstName}} {{user.assignedto.users.lastName}} </td>
      </ng-container>
      <ng-container matColumnDef="startdate">
          <th mat-header-cell  mat-sort-header *matHeaderCellDef><h6> Start Date </h6></th>
          <td mat-cell *matCellDef="let user"> {{user.startdate | date: 'dd/MMM/yyyy h:mm:ss a'}} </td>
        </ng-container>
  
      <ng-container matColumnDef="campingmembers">
        <th mat-header-cell mat-sort-header *matHeaderCellDef> <h6>Campaign Members </h6></th>
        <td mat-cell *matCellDef="let user" style="padding:16px">
            <div class="dropdown" style="float:left;">
            <mat-icon class="dropbtn" style="color:#EE7600;font-size:30px">view_headline</mat-icon>
            <div class="dropdown-content" style="left:0; margin-left: 30px; margin-top: -30px; padding: 10px; max-height:300px">
                <tr *ngFor="let mem of user.customerId;">
                    <td>{{mem.Name | titlecase}}  </td> <!--{{mem.Mobile}}-->
                  </tr>
              </div>
              </div>
        </td>
      </ng-container>
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef><h6> Status  </h6></th>
        <td mat-cell *matCellDef="let user">
            <span style="color:rgb(30, 36, 30); font-size: 16px" *ngIf="user.campingStatus == undefined || user.campingStatus == null || !user.campingStatus">Idle</span>
         <span style="color:#4CAF50; font-size: 16px" *ngIf="user.campingStatus && user.campingStatus.queueStatus == 0 && user.campingStatus.status == 1">Running</span>
         <span style="color:rgb(228, 128, 15); font-size: 16px" *ngIf="user.campingStatus && user.campingStatus.queueStatus == 0 && user.campingStatus.status == 4">Stopped</span>
         <span style="color:rgb(194, 63, 11); font-size: 16px"  *ngIf="user.campingStatus && user.campingStatus.status == 2">Queue( {{ user.campingStatus.queueStatus}})</span>
         <span style="color:rgb(13, 14, 13); font-size: 16px" *ngIf="user.campingStatus && user.campingStatus.queueStatus == 0 && user.campingStatus.status == 3">Completed</span>
        </td>
      </ng-container>
      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef><h6> Action  </h6></th>
        <td mat-cell *matCellDef="let user">
          <span *ngIf="user.campingStatus == undefined || user.campingStatus == null || !user.campingStatus">
              <button mat-raised-button style="color:white; background-color:#4CAF50; padding:0" *ngIf="user.campingStatus == undefined" (click)="RunCampaign(user._id, undefined)"> RUN </button>
          </span>
          <span *ngIf="user.campingStatus != undefined">
              <button mat-raised-button style="color:white; background-color:rgb(255,165,0); padding:0" *ngIf="user.campingStatus.status == 4" (click)="RunCampaign(user._id, user.campingStatus.status)"> RESUME </button>
              <button mat-raised-button style="color:white; background-color:#4CAF50; padding:0" *ngIf="user.campingStatus.status == 3" (click)="RunCampaign(user._id, user.campingStatus.status)"> RUN </button>
           <!-- <button mat-raised-button style="color:white; background-color:#4CAF50" *ngIf="user.campingStatus == undefined || user.campingStatus == null || !user.campingStatus || user.campingStatus.status == 3 || user.campingStatus.status == 4" (click)="RunCampaign(user._id)"> RUN </button> -->
           <button mat-raised-button style="color:white; background-color:#ce2b2b" *ngIf="user.campingStatus && user.campingStatus.status == 2 || user.campingStatus.status == 1" (click)="StopCampaign(user._id, user.campingStatus.status)"> STOP </button>
          </span>
           </td>
      </ng-container>
  
      <ng-container matColumnDef="edit">
        <th mat-header-cell *matHeaderCellDef><h6> Edit  </h6></th>
        <td mat-cell *matCellDef="let user" style="min-width: 50px;text-align: center">
          <!-- <button mat-raised-button color="primary" (click)="editCampaign(user._id)"> 
            Edit
           
          </button> -->
       <a class="pointer"> <mat-icon color="primary" (click)="editCampaign(user._id)">edit</mat-icon></a>
        
        </td>
      </ng-container>
      <ng-container matColumnDef="delete">
        <th mat-header-cell *matHeaderCellDef><h6>Delete  </h6></th>
        <td mat-cell *matCellDef="let user" style="min-width: 50px;text-align: center">
          <!-- <button mat-raised-button style="color:white;background-color: #ce2b2b" (click)="deleteCampaign(user.campingname)"> 
            Delete
         
          </button> -->
       <a class="pointer">  <mat-icon style="color:#ce2b2b;" (click)="deleteCampaign(user._id)">delete_forever</mat-icon></a>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="tryData"></tr>
      <tr mat-row *matRowDef="let row; columns: tryData;"></tr>
      <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
  
  
    </table>
  </div>
  </div>
  <!---------------------------------------------------------------------------------------->
  
  </div>
  
  
  <!-------------------------------------Mat Table ------------------------------------->
  <!-- <mat-form-field>
    <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
  </mat-form-field>
  <div  class="box">
  <mat-table [dataSource]="CampaignData" matSort >
  <ng-container matColumnDef="select" style="max-width: 50px">
  <mat-header-cell *matHeaderCellDef>
  <mat-checkbox (change)="$event ? masterToggle() : null"
        [checked]="selection.hasValue() && isAllSelected()"
        [indeterminate]="selection.hasValue() && !isAllSelected()"
        [aria-label]="checkboxLabel()">
  </mat-checkbox>
  </mat-header-cell>
  <mat-cell *matCellDef="let row">
  <mat-checkbox (click)="$event.stopPropagation()"
        (change)="$event ? selection.toggle(row) : null"
        [checked]="selection.isSelected(row)"
        [aria-label]="checkboxLabel(row)">
  </mat-checkbox>
  </mat-cell>
  </ng-container>
  <ng-container matColumnDef="S No">
   <mat-header-cell *matHeaderCellDef > S No </mat-header-cell>
   <mat-cell *matCellDef="let user; let i = index;">
    {{i+1}}
   </mat-cell>
  </ng-container>
  <ng-container matColumnDef="campigname">
    <mat-header-cell mat-sort-header *matHeaderCellDef>Campaign Name</mat-header-cell>
    <mat-cell *matCellDef="let user"> {{user.campingname | titlecase }} </mat-cell>
  </ng-container>
  <ng-container matColumnDef="startdate">
      <mat-header-cell  mat-sort-header *matHeaderCellDef><h6> Start Date </h6></mat-header-cell>
      <mat-cell *matCellDef="let user"> {{user.startdate | date: 'dd/MMM/yyyy h:mm:ss a'}} </mat-cell>
    </ng-container>
    <ng-container matColumnDef="getCreatedByname">
        <mat-header-cell mat-sort-header *matHeaderCellDef><h6> Created By </h6> </mat-header-cell>
        <mat-cell *matCellDef="let user"> {{user.getCreatedByname}} </mat-cell>
      </ng-container>
      <ng-container matColumnDef="assignedtoByname">
        <mat-header-cell mat-sort-header *matHeaderCellDef><h6> Assigned To</h6></mat-header-cell>
        <mat-cell *matCellDef="let user"> {{user.assignedtoByname}} </mat-cell>
      </ng-container>
      <ng-container matColumnDef="createdAt">
          <mat-header-cell mat-sort-header *matHeaderCellDef><h6> Created At </h6></mat-header-cell>
          <mat-cell *matCellDef="let user"> {{user.createdAt | date: 'dd/MMM/yyyy h:mm:ss a'}} </mat-cell>
        </ng-container>
        <ng-container matColumnDef="campingmembers">
            <mat-header-cell mat-sort-header *matHeaderCellDef> <h6>Campaign Members </h6></mat-header-cell>
            <mat-cell *matCellDef="let user">
             
              <mat-row *ngFor="let mem of user.campingmembers;">
                <mat-cell>{{mem}} </mat-cell>
              </mat-row>
            </mat-cell>
          </ng-container>
          <ng-container matColumnDef="edit">
              <mat-header-cell *matHeaderCellDef><h6> Edit  </h6></mat-header-cell>
              <mat-cell *matCellDef="let user">
                <button mat-raised-button color="primary" (click)="editCampaign(user._id)"> Edit
                </button>
              </mat-cell>
            </ng-container>
            <ng-container matColumnDef="delete">
              <mat-header-cell *matHeaderCellDef><h6>Delete  </h6></mat-header-cell>
              <mat-cell *matCellDef="let user">
                <button mat-raised-button color="red" (click)="deleteCampaign(user.campingname)"> Delete
                </button>
              </mat-cell>
            </ng-container>
   <mat-header-row *matHeaderRowDef="tryData1">
   </mat-header-row>
   <mat-row *matRowDef="let row; columns: tryData1" ></mat-row>
  </mat-table>
  <mat-paginator    [length]="100"  [pageSize]="5" [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
  </div> -->